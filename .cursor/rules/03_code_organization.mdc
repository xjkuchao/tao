---
description: 代码组织、执行计划管理和文件管理规范
globs:
    - "**/*.rs"
    - "**/*.md"
---

# 代码组织与文件管理

## 代码组织原则

- 确保项目模块化, 避免单一函数过于复杂 (建议单个函数不超过 50 行)
- 按功能分类组织代码结构, 遵循现有的 crate 划分和目录结构
- 复杂模块应拆分为多个子模块, 每个子模块职责单一
- 公共类型集中定义在对应 crate 中, 避免散落
- 新增编解码器实现应放在 `tao-codec` 下对应子目录中
- 新增容器格式实现应放在 `tao-format` 下对应子目录中

## 执行计划管理

- **必须**: AI 在制定执行计划时, 必须将计划文件写入 `plans/` 目录
- **命名规范**: 计划文件命名格式为 `{功能模块}_{任务描述}.md`
    - 示例: `h264_decoder_improvement.md`
- **计划内容**: 计划文件应包含:
    - 任务背景和目标
    - 详细执行步骤 (带编号)
    - 每步的预期产出
    - 依赖项和前置条件
    - 验收标准
- **断点续执行**: 计划文件应支持断点续执行, AI 应在计划中标记已完成的步骤
- **跨 AI 协作**: 计划文件应足够详细, 使得不同 AI 工具可以基于同一计划继续执行

## 根目录文件管理

- **严格禁止**: 不允许在项目根目录下随意创建新文件

### 允许的根目录文件

- 项目配置: `Cargo.toml`, `.rustfmt.toml`, `.gitignore`
- 核心文档: `README.md`
- License 文件: `LICENSE`, `LICENSE-MIT`, `LICENSE-APACHE`

### 文件存放位置

- 执行计划: 必须放在 `plans/` 目录
- 技术文档: 放在 `docs/` 目录 (如有)
- 示例代码: 放在 `examples/` 目录
- 样本清单: 放在 `samples/` 目录 (SAMPLE_URLS.md, SAMPLES.md)
- 测试数据: 放在 `data/` 目录
- 历史遗留文件: 应逐步迁移到对应目录
