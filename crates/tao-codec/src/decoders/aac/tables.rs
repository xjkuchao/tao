//! AAC 解码器常量数据表.

pub(super) const AAC_MP4_LEADING_TRIM_SAMPLES: usize = 1024;
/// AAC 时域输出增益校准.
///
/// AAC 频谱反量化后需经过较大缩放, 该系数用于把时域样本归一到 [-1, 1].
/// 过大将导致大量削顶并破坏与参考实现的一致性.
pub(super) const AAC_OUTPUT_GAIN: f32 = 0.0004882132;

/// AAC 采样率索引表
pub(super) const AAC_SAMPLE_RATES: [u32; 16] = [
    96000, 88200, 64000, 48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000, 7350, 0, 0,
    0,
];

/// 96kHz 下 1024 点 LONG 窗口的 SFB 边界.
pub(super) const SWB_OFFSET_1024_96: [usize; 42] = [
    0, 4, 8, 12, 16, 20, 24, 28, 32, 36, 40, 44, 48, 52, 56, 64, 72, 80, 88, 96, 108, 120, 132,
    144, 156, 172, 188, 212, 240, 276, 320, 384, 448, 512, 576, 640, 704, 768, 832, 896, 960, 1024,
];

/// 64kHz 下 1024 点 LONG 窗口的 SFB 边界.
pub(super) const SWB_OFFSET_1024_64: [usize; 48] = [
    0, 4, 8, 12, 16, 20, 24, 28, 32, 36, 40, 44, 48, 52, 56, 64, 72, 80, 88, 100, 112, 124, 140,
    156, 172, 192, 216, 240, 268, 304, 344, 384, 424, 464, 504, 544, 584, 624, 664, 704, 744, 784,
    824, 864, 904, 944, 984, 1024,
];

/// 48kHz/44.1kHz 下 1024 点 LONG 窗口的 SFB 边界.
pub(super) const SWB_OFFSET_1024_48: [usize; 50] = [
    0, 4, 8, 12, 16, 20, 24, 28, 32, 36, 40, 48, 56, 64, 72, 80, 88, 96, 108, 120, 132, 144, 160,
    176, 196, 216, 240, 264, 292, 320, 352, 384, 416, 448, 480, 512, 544, 576, 608, 640, 672, 704,
    736, 768, 800, 832, 864, 896, 928, 1024,
];

/// 32kHz 下 1024 点 LONG 窗口的 SFB 边界.
pub(super) const SWB_OFFSET_1024_32: [usize; 52] = [
    0, 4, 8, 12, 16, 20, 24, 28, 32, 36, 40, 48, 56, 64, 72, 80, 88, 96, 108, 120, 132, 144, 160,
    176, 196, 216, 240, 264, 292, 320, 352, 384, 416, 448, 480, 512, 544, 576, 608, 640, 672, 704,
    736, 768, 800, 832, 864, 896, 928, 960, 992, 1024,
];

/// 24kHz/22.05kHz 下 1024 点 LONG 窗口的 SFB 边界.
pub(super) const SWB_OFFSET_1024_24: [usize; 48] = [
    0, 4, 8, 12, 16, 20, 24, 28, 32, 36, 40, 44, 52, 60, 68, 76, 84, 92, 100, 108, 116, 124, 136,
    148, 160, 172, 188, 204, 220, 240, 260, 284, 308, 336, 364, 396, 432, 468, 508, 552, 600, 652,
    704, 768, 832, 896, 960, 1024,
];

/// 16kHz/12kHz/11.025kHz 下 1024 点 LONG 窗口的 SFB 边界.
pub(super) const SWB_OFFSET_1024_16: [usize; 44] = [
    0, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 100, 112, 124, 136, 148, 160, 172, 184, 196, 212,
    228, 244, 260, 280, 300, 320, 344, 368, 396, 424, 456, 492, 532, 572, 616, 664, 716, 772, 832,
    896, 960, 1024,
];

/// 8kHz/7.35kHz 下 1024 点 LONG 窗口的 SFB 边界.
pub(super) const SWB_OFFSET_1024_8: [usize; 41] = [
    0, 12, 24, 36, 48, 60, 72, 84, 96, 108, 120, 132, 144, 156, 172, 188, 204, 220, 236, 252, 268,
    288, 308, 328, 348, 372, 396, 420, 448, 476, 508, 544, 580, 620, 664, 712, 764, 820, 880, 944,
    1024,
];

/// 96kHz/88.2kHz/64kHz 下 128 点 SHORT 窗口的 SFB 边界.
pub(super) const SWB_OFFSET_128_96: [usize; 13] =
    [0, 4, 8, 12, 16, 20, 24, 32, 40, 48, 64, 92, 128];

/// 48kHz/44.1kHz/32kHz 下 128 点 SHORT 窗口的 SFB 边界.
pub(super) const SWB_OFFSET_128_48: [usize; 15] =
    [0, 4, 8, 12, 16, 20, 28, 36, 44, 56, 68, 80, 96, 112, 128];

/// 24kHz/22.05kHz 下 128 点 SHORT 窗口的 SFB 边界.
pub(super) const SWB_OFFSET_128_24: [usize; 16] = [
    0, 4, 8, 12, 16, 20, 24, 28, 36, 44, 52, 64, 76, 92, 108, 128,
];

/// 16kHz/12kHz/11.025kHz 下 128 点 SHORT 窗口的 SFB 边界.
pub(super) const SWB_OFFSET_128_16: [usize; 16] = [
    0, 4, 8, 12, 16, 20, 24, 28, 32, 40, 48, 60, 72, 88, 108, 128,
];

/// 8kHz/7.35kHz 下 128 点 SHORT 窗口的 SFB 边界.
pub(super) const SWB_OFFSET_128_8: [usize; 16] = [
    0, 4, 8, 12, 16, 20, 24, 28, 36, 44, 52, 60, 72, 88, 108, 128,
];

/// AAC TNS 最大频带数表 (索引为采样率索引).
pub(super) const TNS_MAX_BANDS_1024: [u8; 13] =
    [31, 31, 34, 40, 42, 51, 46, 46, 42, 42, 42, 39, 39];
pub(super) const TNS_MAX_BANDS_128: [u8; 13] = [9, 9, 10, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14];

/// AAC TNS 系数量化反查表 (与 FFmpeg `ff_tns_tmp2_map` 一致).
pub(super) const TNS_TMP2_MAP_1_3: [f32; 4] = [0.0, -0.433_883_73, 0.642_787_6, 0.342_020_15];
pub(super) const TNS_TMP2_MAP_0_3: [f32; 8] = [
    0.0,
    -0.433_883_73,
    -0.781_831_5,
    -0.974_927_9,
    0.984_807_7,
    0.866_025_4,
    0.642_787_6,
    0.342_020_15,
];
pub(super) const TNS_TMP2_MAP_1_4: [f32; 8] = [
    0.0,
    -0.207_911_7,
    -0.406_736_64,
    -0.587_785_24,
    0.673_695_6,
    0.526_432_16,
    0.361_241_67,
    0.183_749_51,
];
pub(super) const TNS_TMP2_MAP_0_4: [f32; 16] = [
    0.0,
    -0.207_911_7,
    -0.406_736_64,
    -0.587_785_24,
    -0.743_144_8,
    -0.866_025_4,
    -0.951_056_54,
    -0.994_521_9,
    0.995_734_16,
    0.961_825_6,
    0.895_163_3,
    0.798_017_2,
    0.673_695_6,
    0.526_432_16,
    0.361_241_67,
    0.183_749_51,
];

pub(super) const NOISE_OFFSET: i32 = 90;
pub(super) const NOISE_PRE: i32 = 256;
pub(super) const NOISE_HCB: u8 = 13;
pub(super) const INTENSITY_HCB2: u8 = 14;
pub(super) const INTENSITY_HCB: u8 = 15;
